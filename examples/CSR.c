/**
 *     ____             _________                __                _
 *    / __ \___  ____ _/ /_  __(_)___ ___  ___  / /   ____  ____ _(_)____
 *   / /_/ / _ \/ __ `/ / / / / / __ `__ \/ _ \/ /   / __ \/ __ `/ / ___/
 *  / _, _/  __/ /_/ / / / / / / / / / / /  __/ /___/ /_/ / /_/ / / /__
 * /_/ |_|\___/\__,_/_/ /_/ /_/_/ /_/ /_/\___/_____/\____/\__, /_/\___/
 *                                                       /____/
 *
 *                 SharkSSL Embedded SSL/TLS Stack
 ****************************************************************************
 *   PROGRAM MODULE
 *
 *   $Id: CSR.c 4007 2017-02-26 21:17:59Z gianluca $
 *
 *   COPYRIGHT:  Real Time Logic LLC, 2018
 *
 *   This software is copyrighted by and is the sole property of Real
 *   Time Logic LLC.  All rights, title, ownership, or other interests in
 *   the software remain the property of Real Time Logic LLC.  This
 *   software may only be used in accordance with the terms and
 *   conditions stipulated in the corresponding license agreement under
 *   which the software has been supplied.  Any unauthorized use,
 *   duplication, transmission, distribution, or disclosure of this
 *   software is expressly forbidden.
 *
 *   This Copyright notice may not be removed or modified without prior
 *   written consent of Real Time Logic LLC.
 *
 *   Real Time Logic LLC. reserves the right to modify this software
 *   without notice.
 *
 *               http://realtimelogic.com
 *               http://sharkssl.com
 ****************************************************************************
 *
 */

/* This SharkSSL client example shows how to create a CSR (certificate signing
   request) and how to sign it with a CA certificate.
 */

#include <SharkSslASN1.h>



#if ((!SHARKSSL_ENABLE_CSR_CREATION) && (!SHARKSSL_ENABLE_CSR_SIGNING))
#error Please enable SHARKSSL_ENABLE_CSR_CREATION and/or SHARKSSL_ENABLE_CSR_SIGNING
#endif


#if (SHARKSSL_ENABLE_CSR_CREATION || SHARKSSL_ENABLE_CSR_SIGNING || SHARKSSL_ENABLE_ASN1_KEY_CREATION)
int base64Encode(const U8 *data,
                 int dataLen,
                 char *b64Data,
                 int b64DataLen)
{
   static const int modTable[] = {0, 2, 1};
   static const char b64alpha[] = {
      "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
   };

   int i,j;
   i = 4 * ((dataLen + 2) / 3);
   if(i > b64DataLen)
   {
      return -1;
   }
   b64DataLen=i;
   for (i = 0, j = 0; i < dataLen;)
   {

      U32 octet_a = i < dataLen ? data[i++] : 0;
      U32 octet_b = i < dataLen ? data[i++] : 0;
      U32 octet_c = i < dataLen ? data[i++] : 0;
      U32 triple = (octet_a << 0x10) + (octet_b << 0x08) + octet_c;
      b64Data[j++] = b64alpha[(triple >> 3 * 6) & 0x3F];
      b64Data[j++] = b64alpha[(triple >> 2 * 6) & 0x3F];
      b64Data[j++] = b64alpha[(triple >> 1 * 6) & 0x3F];
      b64Data[j++] = b64alpha[(triple >> 0 * 6) & 0x3F];
   }
   for (i = 0; i < modTable[dataLen % 3]; i++)
   {
      b64Data[b64DataLen - 1 - i] = '=';
   }
   return b64DataLen;
}


void
printOutBase64(U8 *csrData, int csrDataLen, const char *begin, const char *end)
{
   char *ba64buf, *ba64ptr;
   int ba64len, cnt;

   cnt = 4 * ((csrDataLen + 2) / 3);
   ba64buf = (char*)baMalloc(cnt);
   if (ba64buf != NULL)
   {
      printf("%s", begin);
      ba64len = base64Encode(csrData, csrDataLen, ba64buf, cnt);
      ba64ptr = ba64buf;
      cnt = 0;
      while (ba64len > 0)
      {
         printf("%c", *ba64ptr);
         ba64ptr++;
         ba64len--;
         cnt++;
         if (cnt >= 64 /* characters per row */)
         {
            if (ba64len)
            {
               cnt = 0;
               printf("\n");
            }
         }
      }
      printf("%s", end);
      baFree(ba64buf);
   }
   else
   {
      printf("error in allocating buffer for BASE64 conversion");
   }
   printf("\n\n");
}
#endif


#if SHARKSSL_ENABLE_CSR_CREATION 
void printOutCSR(U8 *csrData, int csrDataLen)
{
   static const char beginCSR[]={"-----BEGIN CERTIFICATE REQUEST-----\n"};
   static const char endCSR[]={"\n-----END CERTIFICATE REQUEST-----\n"};

   printOutBase64(csrData, csrDataLen, beginCSR, endCSR);
}


#if SHARKSSL_ENABLE_RSA
/* example RSA key 
 * generation: openssl genrsa 2048
 */
const char *privRSAKeyPEM2048 = 
   "-----BEGIN RSA PRIVATE KEY-----"
   "MIIEpAIBAAKCAQEAsjbyk/l5/lpHeHmOBKAyslV+2oIprXGOfTDKqBh0ktJqCWYs"
   "owbUcrvvHEEuv6ypybBb3Mi8vHg3+BEm/N/PDbh7SblNgb3DGADOgQJ5rCoSHiG2"
   "X8+A9ZWi4ycm3x7cdpn0wpCrHDtyzTTTj9iZbcHAEb4gpsrau8Y+OWpPMZTt+Pwg"
   "ZLEHejPDtvG9tQD9qHfwCJnaH+dgeIZ8Pw5ajAerdlaFbrXqjw6YE/hU9CV3AXbC"
   "2mHif7ybnZKPxBxcUGWJS0thChzzF91b/UZc1H5vT5q7KpvK/UbFJgqFyZvMk3ju"
   "w0XLLVnb/L7JUEM5BKUVoEtqqRIIwSroDnM5XQIDAQABAoIBAHHEbBUUxNEf9tIs"
   "3wGK9vIrbAC36T1E6c53kFfAzOJRmsmHRWWJXaQk3x7taZeI9RbBE9Oc/gdew3QE"
   "FxyFD5vVsja9KYJyjpHLKgjneJ70eH5tzQva3ptoPATAoKr8+4Zm//4Y9nLebIod"
   "eBUzE7ciYaex9QwlIX+PrXdfq1CdjRzy7F+XZwDv8bjbGBLDRDEwnjwIbEcZM8Sg"
   "bVss8hwvZCheffbhH/urIAWSnSF/Uu6/oPzFThOEZPCJoIine3wRGJ7+Wf9ECWXY"
   "339vPrUdBwYaxZHZECV2L+0zS4r9apF3gTH6dump9Qi8/So8pPJyMGmLsa0qkgt+"
   "QWWvVsECgYEA7SbnEdovaLNmhSWhgMcIl23BUFdftlP7IZ4jKLZ6SPHcgR3Ky9IJ"
   "G/PczBI4qkl7ieTB5tGCe9PURp7LfH8Mtr27GH5zWq4xbuCsJDcX2i9Mwsheo2YI"
   "ZFF80v0hn0lTn/3XAAS2/HWA/Duv+BSoJvap60Rgoiw/ABki8hPLq80CgYEAwGDn"
   "v/bIfJZ0uR6xl2yTf16Vgukk/Z+G0vuG+DEUx6W5bHHTUj3hEGSIcADsw/GJhggA"
   "pQ8q1Krgbfq94+amtI+iIgk55egDkn9+Fqy3TjWiYoMfwG8VZJAawcsAFjio0fNn"
   "0pmmc7D7gmR7zZvoUlPwSvsh6fJytqx/AaLa09ECgYBMDGWc+/KoCJ+foumfejPv"
   "G2sacGpo9ZVaunNb4uhj6+tiHEOkCL6TECiF6HHzaY0MMyda9WR6gPtZiiKG0dcp"
   "4r3UpPgo5CNGAxYwptonRXPAIrD2hQm74cW9gx79DW6bp7MCdoCXhLbQK/PKAhXK"
   "KN9kapDycG3jgiwKpP5zIQKBgQCJfrkkQkVYhlA2XvGewENLLVa+kdOWUYYTFSKK"
   "EMpBRvkXwOLATOmmxbOeGYsfIGqiGOYdEpISHW76K9O8JwXO1zmSCfYPk5u6ANUl"
   "b5wzkbHVptHyv3ISxcvZ5jTRrP070TPLGXYWCdA4iYjSkzOgY83CSWsbweSrGu5L"
   "RRIRgQKBgQCHgwPwjwEX9ESNWHJf+DqZBdiFFyQTsTt/gcjf7XJkD30HhmT+p9LA"
   "UoXMqohuewley97aSFL5sPU/GqEWYGL0aQsl9b50ZZFVwK1mIcbyCY17DTtr7Nof"
   "Vak9hq6oTL0ETDLF5YOTtLAG2ODDySBNPtZI8qTygvkiRVT7+ZYB6w=="
   "-----END RSA PRIVATE KEY-----";
#endif


#if SHARKSSL_USE_ECC
/* example ECC key (FIPS curve)
 * generation: openssl ecparam -genkey -name secp256r1 -noout
 */
#if (!SHARKSSL_ECC_USE_SECP256R1)
#error SHARKSSL_ECC_USE_SECP256R1 must be set to 1
#endif
const char *privECKeyPEM256 = 
   "-----BEGIN EC PRIVATE KEY-----"
   "MHcCAQEEINknFzimTBHmufsa1sOgBjjEKGIkrtp3zzMaIF+D0G4woAoGCCqGSM49"
   "AwEHoUQDQgAENbkxphHMcApSxFtacAX3o5P038qACcJqguPXT9rv6q22GfiILcaV"
   "j+IyxZscAX5B5AsFSP4KBy3j3KwqGYu2zg=="
   "-----END EC PRIVATE KEY-----";
#endif
#if (SHARKSSL_ECC_USE_BRAINPOOLP256R1)
/* example ECC key (Brainpool curve - RFC 5639)
 * generation: openssl ecparam -genkey -name brainpoolP256r1 -noout
 */
const char *privECBKeyPEM256 = 
   "-----BEGIN EC PRIVATE KEY-----"
   "MHgCAQEEIICx58Je3eTr7DyyrsBPTL8ILWo7KxEibNCyC466VnXeoAsGCSskAwMC"
   "CAEBB6FEA0IABHvgzYwI92dWK6aC9Eg2lQZur12J4s1HSipKNrYzpGKTcENYz0Rb"
   "V0ElEDvx+F+nb8lGbAJT3AIhHmA+SI728/g=\n"
   "-----END EC PRIVATE KEY-----";
#endif
#endif  /* SHARKSSL_ENABLE_CSR_CREATION */


#if SHARKSSL_ENABLE_CSR_SIGNING
void printOutCert(U8 *csrData, int csrDataLen)
{
   static const char beginCert[]={"-----BEGIN CERTIFICATE-----\n"};
   static const char endCert[]={"\n-----END CERTIFICATE-----\n"};

   printOutBase64(csrData, csrDataLen, beginCert, endCert);
}


/* Prints out an array with HEX values */
void printOutBytes(unsigned char *char_seq, int char_len)
{
   char i = 0;

   while (char_len > 0)
   {
      printf("0x%02X",*char_seq);
      char_seq++;
      char_len--;

      if (char_len > 0)
      {
         printf(", ");
      }

      i++;
      if (i >= 16 /* bytes per row */)
      {
         if (char_len)
         {
            i = 0;
            printf("\n   ");
         }
      }
   }
}


/* CSR signing using hard coded from/to dates and serial number */
int signCSR(char *name, 
            U8 *csrData, 
            int csrDataLen,
            SharkSslCert CAcert,
            SharkSslKey privKey,
            U8 hashID)
{
   int certLen;
   SharkSslCert signedCSR;
   static const char *dateFrom = "20171230080102"; /* 2017-12-30 08:01:02 */
   static const char *dateTo   = "20271230080102"; /* 2027-12-30 08:01:02 */

   certLen = SharkSslCert_signCSR(&signedCSR,
                              csrData, csrDataLen,
                              CAcert, privKey,
                              (char*)dateFrom, (char*)dateTo,
                              0x010203,
                              hashID);

   if (certLen > 0)
   {
      /* 
       * The certificate is in the first bytes of signedCSR.  
       * The certificate length is obtained by SharkSslCert_len
       */
      printOutCert((U8*)signedCSR, SharkSslCert_len(signedCSR));

      /*
       * Print out the full content of signed CSR certificate +
       * private key in SharkSSL internal format.
       */
      printf("const U8 signedCSR_%s[%d] =\n{\n   ", name, certLen);
      printOutBytes((unsigned char*)signedCSR, certLen);
      printf("\n};\n\n");
      /* release the memory */
      baFree((void*)signedCSR);
   }
   else
   {
      printf("%s CSR signing error\n", name);
   }
   return certLen;
}


/* demo CSR for signing only feature */
const U8 csrTest[893] =
{   
   0x30, 0x82, 0x03, 0x79, 0x30, 0x82, 0x02, 0x61, 0x02, 0x00, 0x30, 0x81, 0xBA, 0x31, 0x1E, 0x30,
   0x1C, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x15, 0x77, 0x77, 0x77, 0x2E, 0x72, 0x65, 0x61, 0x6C,
   0x74, 0x69, 0x6D, 0x65, 0x6C, 0x6F, 0x67, 0x69, 0x63, 0x2E, 0x63, 0x6F, 0x6D, 0x31, 0x18, 0x30,
   0x16, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0F, 0x52, 0x65, 0x61, 0x6C, 0x20, 0x54, 0x69, 0x6D,
   0x65, 0x20, 0x4C, 0x6F, 0x67, 0x69, 0x63, 0x31, 0x1D, 0x30, 0x1B, 0x06, 0x03, 0x55, 0x04, 0x0B,
   0x13, 0x14, 0x53, 0x68, 0x61, 0x72, 0x6B, 0x53, 0x53, 0x4C, 0x20, 0x64, 0x65, 0x76, 0x65, 0x6C,
   0x6F, 0x70, 0x6D, 0x65, 0x6E, 0x74, 0x31, 0x16, 0x30, 0x14, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13,
   0x0D, 0x4C, 0x61, 0x67, 0x75, 0x6E, 0x61, 0x20, 0x4E, 0x69, 0x67, 0x75, 0x65, 0x6C, 0x31, 0x13,
   0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0A, 0x43, 0x61, 0x6C, 0x69, 0x66, 0x6F, 0x72,
   0x6E, 0x69, 0x61, 0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53,
   0x31, 0x25, 0x30, 0x23, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x09, 0x01, 0x13,
   0x16, 0x69, 0x6E, 0x66, 0x6F, 0x40, 0x72, 0x65, 0x61, 0x6C, 0x74, 0x69, 0x6D, 0x65, 0x6C, 0x6F,
   0x67, 0x69, 0x63, 0x2E, 0x63, 0x6F, 0x6D, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0D, 0x06, 0x09, 0x2A,
   0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0F, 0x00, 0x30,
   0x82, 0x01, 0x0A, 0x02, 0x82, 0x01, 0x01, 0x00, 0xC1, 0xA2, 0xF4, 0x98, 0xC8, 0x54, 0x57, 0xB7,
   0x60, 0x24, 0x6D, 0xFD, 0x9E, 0x2F, 0x7C, 0xCD, 0x31, 0x93, 0x5B, 0xC9, 0x98, 0x98, 0xDD, 0x49,
   0xDD, 0x79, 0xE0, 0xFD, 0x50, 0x9A, 0x88, 0x09, 0x7A, 0x98, 0x62, 0x8E, 0x6D, 0xBE, 0x06, 0x7F,
   0x09, 0x8D, 0xB1, 0x2B, 0xB6, 0x41, 0x24, 0x42, 0x7B, 0xF7, 0x04, 0x2D, 0x4E, 0xB6, 0x31, 0xB8,
   0x85, 0x34, 0xC3, 0xC4, 0x26, 0xC9, 0x4B, 0x10, 0x5A, 0x85, 0x89, 0x7C, 0xFB, 0x2E, 0x78, 0x0A,
   0xA4, 0x5F, 0x7A, 0xC0, 0x8B, 0x0F, 0xAD, 0x8C, 0xF5, 0xD7, 0x96, 0xA9, 0x2B, 0xD9, 0x16, 0x7D,
   0x2D, 0xCD, 0x5B, 0x7B, 0x29, 0x94, 0xE8, 0x04, 0x13, 0x9F, 0xC8, 0xAA, 0x60, 0x49, 0x74, 0x29,
   0x98, 0x78, 0xFC, 0x32, 0x77, 0x8D, 0xC5, 0x33, 0xEC, 0x66, 0x03, 0x2D, 0xAB, 0x59, 0x11, 0x59,
   0x8D, 0x84, 0xEB, 0x47, 0x0F, 0x1A, 0xA9, 0x05, 0x05, 0x9B, 0xAE, 0x90, 0x64, 0x2C, 0xF8, 0xE1,
   0x8E, 0xBA, 0x20, 0x01, 0xC0, 0x9B, 0x2B, 0x16, 0xEA, 0x0B, 0xD9, 0xC3, 0x52, 0x10, 0x04, 0x69,
   0x99, 0x45, 0xF6, 0x21, 0x96, 0x1F, 0x36, 0xC1, 0x8C, 0xD4, 0xD4, 0x91, 0xEC, 0xB6, 0xFB, 0xC6,
   0xF0, 0x66, 0x8A, 0xFC, 0x33, 0xE5, 0x54, 0x5D, 0x90, 0x31, 0x13, 0xFE, 0x72, 0xFD, 0x36, 0x84,
   0x00, 0x31, 0xC0, 0x4D, 0x5C, 0x3E, 0x3D, 0x4D, 0x62, 0xBB, 0x74, 0xCE, 0x1A, 0x5B, 0x36, 0x47,
   0x75, 0x00, 0x63, 0xB0, 0x9B, 0x65, 0x02, 0x3A, 0x16, 0x03, 0xDE, 0xDB, 0x6F, 0xCC, 0xF4, 0xD4,
   0x38, 0xD7, 0xCC, 0x9E, 0x0B, 0xD7, 0x01, 0x63, 0xDF, 0x27, 0x5E, 0xA8, 0x24, 0xCC, 0x2F, 0x95,
   0x7D, 0x74, 0x88, 0x6D, 0x81, 0x94, 0x38, 0xA8, 0x8C, 0xD9, 0x4A, 0x2B, 0xC8, 0x0F, 0x7A, 0x34,
   0x88, 0x7F, 0x57, 0x49, 0x7B, 0x6B, 0x44, 0x93, 0x02, 0x03, 0x01, 0x00, 0x01, 0xA0, 0x7A, 0x30,
   0x78, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x09, 0x0E, 0x31, 0x6B, 0x30, 0x69,
   0x30, 0x47, 0x06, 0x03, 0x55, 0x1D, 0x11, 0x04, 0x40, 0x30, 0x3E, 0x87, 0x04, 0x7F, 0x00, 0x00,
   0x01, 0x82, 0x15, 0x65, 0x6D, 0x62, 0x65, 0x64, 0x64, 0x65, 0x64, 0x77, 0x65, 0x62, 0x73, 0x65,
   0x72, 0x76, 0x65, 0x72, 0x2E, 0x6E, 0x65, 0x74, 0x82, 0x0C, 0x73, 0x68, 0x61, 0x72, 0x6B, 0x73,
   0x73, 0x6C, 0x2E, 0x63, 0x6F, 0x6D, 0x82, 0x11, 0x72, 0x65, 0x61, 0x6C, 0x74, 0x69, 0x6D, 0x65,
   0x6C, 0x6F, 0x67, 0x69, 0x63, 0x2E, 0x63, 0x6F, 0x6D, 0x30, 0x0B, 0x06, 0x03, 0x55, 0x1D, 0x0F,
   0x04, 0x04, 0x03, 0x02, 0x01, 0xFE, 0x30, 0x11, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x86, 0xF8,
   0x42, 0x01, 0x01, 0x04, 0x04, 0x03, 0x02, 0x00, 0xD5, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48,
   0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0B, 0x05, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00, 0x26, 0xA0, 0xC2,
   0x98, 0x94, 0x16, 0xF3, 0xAB, 0xB5, 0xD9, 0x7D, 0xE4, 0xBA, 0xF3, 0xC0, 0x4E, 0x69, 0x0F, 0x2F,
   0xD7, 0x67, 0xAD, 0xD8, 0xBD, 0xC8, 0xB7, 0x40, 0x77, 0xB9, 0xD0, 0x48, 0x09, 0x1E, 0xF2, 0xA1,
   0xA1, 0x5C, 0xC7, 0x1B, 0xE5, 0x87, 0xB8, 0x94, 0x64, 0x96, 0xE4, 0xED, 0x13, 0x7A, 0x41, 0x5B,
   0xB7, 0x0F, 0xD8, 0x75, 0x0C, 0xE8, 0xCD, 0xD0, 0xDE, 0x01, 0x75, 0xB4, 0x6A, 0xE0, 0x84, 0x3F,
   0xA5, 0x01, 0x76, 0x96, 0x34, 0xD2, 0x47, 0x37, 0xCC, 0x5C, 0x29, 0xAF, 0x02, 0x85, 0xA3, 0x94,
   0xBF, 0xE2, 0x19, 0xDB, 0xE8, 0x42, 0x79, 0xCD, 0x45, 0x7A, 0x64, 0x7B, 0xF1, 0xE1, 0x6B, 0x33,
   0x36, 0x9E, 0xB0, 0xB0, 0x55, 0x0E, 0x4F, 0xCE, 0x01, 0x4B, 0xED, 0x32, 0x65, 0x08, 0x5F, 0xB3,
   0x02, 0xEE, 0xC3, 0x08, 0x76, 0xFD, 0x74, 0xBA, 0x83, 0x59, 0x1D, 0xE5, 0xD0, 0x7A, 0x6F, 0x30,
   0x2B, 0x81, 0xBD, 0xB5, 0xE5, 0xFD, 0xEC, 0x64, 0xEE, 0x16, 0x17, 0xCA, 0x5F, 0x9F, 0x6A, 0x4C,
   0xEA, 0xC3, 0x00, 0xDB, 0x05, 0x58, 0x20, 0xD6, 0xF3, 0xB6, 0xE2, 0x7F, 0x36, 0x3B, 0xE5, 0x3E,
   0x11, 0x0A, 0xD2, 0xE5, 0x81, 0x43, 0xF5, 0x28, 0xA9, 0x2D, 0xD8, 0x00, 0x54, 0x41, 0xD3, 0xD8,
   0x67, 0x39, 0x24, 0x37, 0x3E, 0xCB, 0x44, 0xED, 0x17, 0x3D, 0x5F, 0x8E, 0xAE, 0xD9, 0x84, 0x15,
   0xAB, 0xC0, 0x6C, 0x5F, 0x77, 0x5D, 0x80, 0x4A, 0xBA, 0x34, 0x47, 0x82, 0x69, 0x03, 0xDB, 0xAF,
   0x9C, 0xE2, 0x57, 0xB5, 0x60, 0x58, 0xDB, 0xFC, 0x46, 0x4C, 0xB5, 0x10, 0x1C, 0x22, 0x49, 0xCB,
   0x60, 0xA7, 0x0D, 0x9F, 0x7E, 0x95, 0x53, 0x5E, 0xD7, 0x74, 0x52, 0x99, 0x73, 0x2A, 0x7E, 0xE4,
   0x5C, 0x65, 0x60, 0x88, 0x58, 0x77, 0x54, 0xA2, 0x05, 0xA2, 0x2E, 0x7C, 0xE8
};


const U8 csrTestKey[912] =
{   
   0x30, 0x82, 0x00, 0x00, 0x00, 0x04, 0x01, 0x00, 0x00, 0x01, 0x00, 0x01, 0xC1, 0xA2, 0xF4, 0x98,
   0xC8, 0x54, 0x57, 0xB7, 0x60, 0x24, 0x6D, 0xFD, 0x9E, 0x2F, 0x7C, 0xCD, 0x31, 0x93, 0x5B, 0xC9,
   0x98, 0x98, 0xDD, 0x49, 0xDD, 0x79, 0xE0, 0xFD, 0x50, 0x9A, 0x88, 0x09, 0x7A, 0x98, 0x62, 0x8E,
   0x6D, 0xBE, 0x06, 0x7F, 0x09, 0x8D, 0xB1, 0x2B, 0xB6, 0x41, 0x24, 0x42, 0x7B, 0xF7, 0x04, 0x2D,
   0x4E, 0xB6, 0x31, 0xB8, 0x85, 0x34, 0xC3, 0xC4, 0x26, 0xC9, 0x4B, 0x10, 0x5A, 0x85, 0x89, 0x7C,
   0xFB, 0x2E, 0x78, 0x0A, 0xA4, 0x5F, 0x7A, 0xC0, 0x8B, 0x0F, 0xAD, 0x8C, 0xF5, 0xD7, 0x96, 0xA9,
   0x2B, 0xD9, 0x16, 0x7D, 0x2D, 0xCD, 0x5B, 0x7B, 0x29, 0x94, 0xE8, 0x04, 0x13, 0x9F, 0xC8, 0xAA,
   0x60, 0x49, 0x74, 0x29, 0x98, 0x78, 0xFC, 0x32, 0x77, 0x8D, 0xC5, 0x33, 0xEC, 0x66, 0x03, 0x2D,
   0xAB, 0x59, 0x11, 0x59, 0x8D, 0x84, 0xEB, 0x47, 0x0F, 0x1A, 0xA9, 0x05, 0x05, 0x9B, 0xAE, 0x90,
   0x64, 0x2C, 0xF8, 0xE1, 0x8E, 0xBA, 0x20, 0x01, 0xC0, 0x9B, 0x2B, 0x16, 0xEA, 0x0B, 0xD9, 0xC3,
   0x52, 0x10, 0x04, 0x69, 0x99, 0x45, 0xF6, 0x21, 0x96, 0x1F, 0x36, 0xC1, 0x8C, 0xD4, 0xD4, 0x91,
   0xEC, 0xB6, 0xFB, 0xC6, 0xF0, 0x66, 0x8A, 0xFC, 0x33, 0xE5, 0x54, 0x5D, 0x90, 0x31, 0x13, 0xFE,
   0x72, 0xFD, 0x36, 0x84, 0x00, 0x31, 0xC0, 0x4D, 0x5C, 0x3E, 0x3D, 0x4D, 0x62, 0xBB, 0x74, 0xCE,
   0x1A, 0x5B, 0x36, 0x47, 0x75, 0x00, 0x63, 0xB0, 0x9B, 0x65, 0x02, 0x3A, 0x16, 0x03, 0xDE, 0xDB,
   0x6F, 0xCC, 0xF4, 0xD4, 0x38, 0xD7, 0xCC, 0x9E, 0x0B, 0xD7, 0x01, 0x63, 0xDF, 0x27, 0x5E, 0xA8,
   0x24, 0xCC, 0x2F, 0x95, 0x7D, 0x74, 0x88, 0x6D, 0x81, 0x94, 0x38, 0xA8, 0x8C, 0xD9, 0x4A, 0x2B,
   0xC8, 0x0F, 0x7A, 0x34, 0x88, 0x7F, 0x57, 0x49, 0x7B, 0x6B, 0x44, 0x93, 0xED, 0x27, 0x96, 0xE3,
   0xE8, 0x37, 0x33, 0xE8, 0xE1, 0x13, 0x78, 0xA8, 0xEF, 0x3B, 0x44, 0xC4, 0x00, 0xAE, 0x79, 0x25,
   0xB8, 0xF9, 0x76, 0x61, 0xF0, 0x09, 0x94, 0x06, 0x46, 0x8C, 0x71, 0x9D, 0x0D, 0x19, 0x4D, 0xD0,
   0xE7, 0x5F, 0x55, 0xE4, 0xA6, 0x2D, 0xF6, 0xFD, 0xA5, 0xEA, 0x58, 0xB3, 0x2D, 0x80, 0x2B, 0x7A,
   0x68, 0xD6, 0x16, 0x0D, 0xB5, 0x8F, 0x08, 0xF7, 0xD5, 0xA1, 0xDD, 0xD2, 0xF8, 0xE6, 0x2C, 0x7F,
   0x4B, 0xDD, 0x43, 0x0F, 0x04, 0xFF, 0xA5, 0xF6, 0x36, 0x02, 0x58, 0x73, 0x4E, 0xEE, 0x90, 0xD9,
   0x27, 0x41, 0xB0, 0xFD, 0xDB, 0xC5, 0x20, 0xCF, 0xF2, 0xE4, 0xE2, 0x85, 0xCE, 0x4F, 0x05, 0xB6,
   0x56, 0x61, 0xC2, 0x68, 0x95, 0xFB, 0xEB, 0xB7, 0x4A, 0xF6, 0x05, 0x4D, 0xFD, 0xAE, 0xDC, 0xF7,
   0xEF, 0x12, 0xAB, 0xFA, 0xEF, 0xDA, 0x10, 0x43, 0xFB, 0x2E, 0xDB, 0xF3, 0xD1, 0x06, 0x15, 0x07,
   0x7C, 0x14, 0x54, 0xD3, 0x8F, 0x48, 0xF6, 0x6A, 0xD4, 0x27, 0xA0, 0x06, 0x1B, 0x3B, 0x54, 0x6A,
   0xD7, 0x15, 0xCA, 0xC3, 0x0C, 0x69, 0x1B, 0x28, 0x98, 0x7F, 0x9E, 0x7F, 0x54, 0xB6, 0xC4, 0xA4,
   0x75, 0xBF, 0x31, 0x48, 0x94, 0x7F, 0xF3, 0xD2, 0x2A, 0x50, 0x28, 0xF6, 0x2C, 0x60, 0xC4, 0x63,
   0x6F, 0x37, 0x99, 0x2E, 0x76, 0xE4, 0x93, 0xB3, 0x00, 0xD1, 0x20, 0xFE, 0x1D, 0x8D, 0x94, 0x12,
   0x79, 0x20, 0x61, 0x04, 0x3D, 0x69, 0x08, 0x0C, 0xC1, 0x9A, 0x42, 0x37, 0x23, 0x98, 0xE6, 0x66,
   0x50, 0x40, 0x5F, 0x32, 0x83, 0xC0, 0xAF, 0xCC, 0xD1, 0xD9, 0xFA, 0x41, 0x03, 0xDD, 0x5C, 0x29,
   0x13, 0x69, 0x51, 0x84, 0x88, 0x36, 0xF8, 0x1C, 0x54, 0x56, 0xE9, 0x36, 0xEC, 0x7A, 0xE4, 0x09,
   0x57, 0xBD, 0xBD, 0x83, 0xAA, 0x88, 0x0C, 0xA6, 0x7C, 0x55, 0x3C, 0xE1, 0x47, 0x7E, 0x50, 0xD9,
   0xC2, 0x0E, 0xAA, 0x42, 0x81, 0x5F, 0xEA, 0x57, 0x1B, 0x4F, 0xC5, 0xCA, 0x44, 0xDE, 0x54, 0x3D,
   0x50, 0x07, 0x3C, 0x6E, 0x07, 0xFC, 0x0B, 0x38, 0xDD, 0x19, 0xC7, 0xC2, 0x6D, 0xC9, 0x7C, 0x11,
   0x07, 0x3F, 0x51, 0x58, 0x8D, 0xD4, 0x7B, 0x8A, 0x39, 0xF3, 0x6C, 0xEC, 0x0F, 0x42, 0x7D, 0x58,
   0xF8, 0xB3, 0xD9, 0x90, 0x26, 0x74, 0xC9, 0x62, 0x55, 0x6F, 0xE7, 0xBC, 0x8B, 0x36, 0x70, 0xA1,
   0xAB, 0x90, 0x37, 0x80, 0x16, 0xA4, 0xAF, 0x36, 0x8B, 0x4F, 0xA7, 0xB4, 0x93, 0x4E, 0x0E, 0x32,
   0xB8, 0xC7, 0xF0, 0x00, 0x87, 0xB9, 0x64, 0xCB, 0xEB, 0xD0, 0x9E, 0x8D, 0x72, 0x05, 0x96, 0x96,
   0x42, 0x72, 0x54, 0x36, 0x4D, 0x48, 0xD5, 0xE5, 0xBA, 0xDE, 0x71, 0xF8, 0xF2, 0x0A, 0x3E, 0x29,
   0x2C, 0x54, 0x77, 0xAE, 0x3D, 0x92, 0x82, 0xA6, 0xCB, 0xD9, 0x73, 0x8B, 0xBB, 0x55, 0xF9, 0x29,
   0x01, 0x22, 0xF3, 0xB7, 0xBC, 0xD6, 0xC6, 0xCB, 0x8E, 0x23, 0x89, 0x7F, 0x8F, 0x8E, 0x88, 0x25,
   0x4D, 0x6A, 0x21, 0x94, 0xD8, 0x9D, 0xA7, 0x12, 0xA6, 0x42, 0xD2, 0xDA, 0x0A, 0x21, 0xD8, 0x72,
   0x11, 0x79, 0xEF, 0x00, 0xBE, 0xDF, 0x42, 0xB6, 0x5C, 0xE8, 0x05, 0x1E, 0x45, 0x3D, 0xE1, 0x25,
   0xC1, 0x3B, 0x12, 0x56, 0x1B, 0x86, 0xD7, 0x7D, 0x7A, 0x40, 0xF4, 0x91, 0xEC, 0x08, 0xC4, 0xEA,
   0x1D, 0x97, 0x50, 0x7C, 0x4D, 0x51, 0xC2, 0x3E, 0x34, 0x92, 0x3D, 0xC0, 0x4F, 0x6E, 0x2D, 0x29,
   0x0B, 0xC9, 0xF5, 0xC8, 0x3F, 0x5F, 0x45, 0xF0, 0x8B, 0x30, 0x12, 0xE3, 0x8C, 0x44, 0x2B, 0xE2,
   0x40, 0x9C, 0x86, 0xCC, 0x02, 0x8D, 0x49, 0xA7, 0x92, 0x4B, 0x66, 0xAF, 0xAC, 0x18, 0xA4, 0x22,
   0x5F, 0x7A, 0x15, 0xCD, 0x58, 0xDC, 0xA0, 0x81, 0xE2, 0x33, 0x3E, 0xE1, 0xAB, 0xCA, 0xB0, 0x95,
   0xDA, 0xF3, 0xE6, 0x7E, 0x0F, 0x76, 0xAE, 0x99, 0xB1, 0xDC, 0xC5, 0x47, 0xE0, 0xF1, 0x30, 0xCE,
   0xBC, 0x2D, 0x85, 0xAD, 0x0A, 0x59, 0x74, 0xED, 0xCB, 0x6B, 0x97, 0x75, 0xD0, 0x01, 0xD7, 0x36,
   0xC0, 0x7E, 0xB8, 0x1C, 0x34, 0xB8, 0xFC, 0x45, 0xFE, 0x87, 0xAC, 0xAD, 0x7C, 0x15, 0x7D, 0x78,
   0x31, 0xC6, 0xDD, 0x8F, 0x41, 0xD5, 0xD9, 0xDA, 0x8C, 0xB2, 0x57, 0xA4, 0xDA, 0x69, 0x0D, 0xC2,
   0x51, 0xBC, 0x27, 0x0C, 0x74, 0xD4, 0xC3, 0xCD, 0xD2, 0x8C, 0xEF, 0xB6, 0xF3, 0xB6, 0x84, 0x56,
   0x79, 0xF2, 0x30, 0x52, 0x6D, 0xC4, 0xE6, 0xEC, 0x03, 0xA6, 0x19, 0x6F, 0x54, 0x36, 0xF9, 0x3F,
   0xCC, 0x61, 0x29, 0x1A, 0xAF, 0x34, 0x87, 0xA0, 0xC3, 0x50, 0xEC, 0xA9, 0xAD, 0xC1, 0x86, 0x1D,
   0x06, 0xDB, 0xBC, 0x38, 0x4D, 0x8E, 0x36, 0xCF, 0xFB, 0xA8, 0x00, 0x80, 0xFF, 0xFF, 0xFF, 0xFF
};
   
   
#if SHARKSSL_ENABLE_RSA
/* example CA certificate and its relevant RSA private key 
 * obtained with SharkSSL\tools\SharkSslParseCert
 *                  SharkSSL\examples\certificates\CA_RTL_RSA_2048.pem
 *                  SharkSSL\examples\certificates\private\CA_RTL_RSA_2048.key
 */ 
const U8 sharkSslRSACertCA_RTL[1888] =
{
   0x30, 0x82, 0x03, 0xCF, 0x30, 0x82, 0x02, 0xB7, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x01, 0x00, 
   0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0B, 0x05, 0x00, 0x30, 
   0x81, 0x88, 0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 
   0x1C, 0x30, 0x1A, 0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x13, 0x52, 0x65, 0x61, 0x6C, 0x20, 0x54, 
   0x69, 0x6D, 0x65, 0x20, 0x4C, 0x6F, 0x67, 0x69, 0x63, 0x20, 0x4C, 0x4C, 0x43, 0x31, 0x11, 0x30, 
   0x0F, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x08, 0x53, 0x68, 0x61, 0x72, 0x6B, 0x53, 0x53, 0x4C, 
   0x31, 0x20, 0x30, 0x1E, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x17, 0x52, 0x65, 0x61, 0x6C, 0x20, 
   0x54, 0x69, 0x6D, 0x65, 0x20, 0x4C, 0x6F, 0x67, 0x69, 0x63, 0x20, 0x52, 0x6F, 0x6F, 0x74, 0x20, 
   0x43, 0x41, 0x31, 0x26, 0x30, 0x24, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x09, 
   0x01, 0x16, 0x17, 0x67, 0x69, 0x6E, 0x66, 0x6F, 0x40, 0x72, 0x65, 0x61, 0x6C, 0x74, 0x69, 0x6D, 
   0x65, 0x6C, 0x6F, 0x67, 0x69, 0x63, 0x2E, 0x63, 0x6F, 0x6D, 0x30, 0x1E, 0x17, 0x0D, 0x31, 0x33, 
   0x31, 0x30, 0x30, 0x34, 0x30, 0x38, 0x35, 0x34, 0x33, 0x37, 0x5A, 0x17, 0x0D, 0x32, 0x33, 0x31, 
   0x30, 0x30, 0x32, 0x30, 0x38, 0x35, 0x34, 0x33, 0x37, 0x5A, 0x30, 0x81, 0x88, 0x31, 0x0B, 0x30, 
   0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x1C, 0x30, 0x1A, 0x06, 0x03, 
   0x55, 0x04, 0x0A, 0x13, 0x13, 0x52, 0x65, 0x61, 0x6C, 0x20, 0x54, 0x69, 0x6D, 0x65, 0x20, 0x4C, 
   0x6F, 0x67, 0x69, 0x63, 0x20, 0x4C, 0x4C, 0x43, 0x31, 0x11, 0x30, 0x0F, 0x06, 0x03, 0x55, 0x04, 
   0x0B, 0x13, 0x08, 0x53, 0x68, 0x61, 0x72, 0x6B, 0x53, 0x53, 0x4C, 0x31, 0x20, 0x30, 0x1E, 0x06, 
   0x03, 0x55, 0x04, 0x03, 0x13, 0x17, 0x52, 0x65, 0x61, 0x6C, 0x20, 0x54, 0x69, 0x6D, 0x65, 0x20, 
   0x4C, 0x6F, 0x67, 0x69, 0x63, 0x20, 0x52, 0x6F, 0x6F, 0x74, 0x20, 0x43, 0x41, 0x31, 0x26, 0x30, 
   0x24, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x09, 0x01, 0x16, 0x17, 0x67, 0x69, 
   0x6E, 0x66, 0x6F, 0x40, 0x72, 0x65, 0x61, 0x6C, 0x74, 0x69, 0x6D, 0x65, 0x6C, 0x6F, 0x67, 0x69, 
   0x63, 0x2E, 0x63, 0x6F, 0x6D, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 
   0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0F, 0x00, 0x30, 0x82, 0x01, 
   0x0A, 0x02, 0x82, 0x01, 0x01, 0x00, 0xAD, 0xDA, 0xA9, 0xB3, 0x9A, 0x4A, 0xD1, 0xEE, 0x80, 0x70, 
   0x0E, 0x79, 0x36, 0x75, 0x92, 0x16, 0x15, 0x5C, 0x13, 0x5D, 0x76, 0x9E, 0xB1, 0x21, 0x93, 0xC3, 
   0x3E, 0x1C, 0xEF, 0xB2, 0xA0, 0x59, 0xD8, 0xDF, 0xAB, 0x5E, 0xD3, 0x25, 0x8A, 0x94, 0xFE, 0x99, 
   0x0D, 0xC9, 0x0A, 0xD0, 0x8C, 0xBF, 0x5A, 0x1E, 0xBE, 0xD8, 0x95, 0xC9, 0xE3, 0x2B, 0x4B, 0x47, 
   0xC0, 0xBD, 0x02, 0xC6, 0xB2, 0xB0, 0x5F, 0xA4, 0x2C, 0x31, 0xBF, 0xE9, 0x71, 0xB8, 0xEF, 0xDD, 
   0x9F, 0xA0, 0xA4, 0x1A, 0xC8, 0xA1, 0x46, 0xDB, 0xED, 0x9A, 0x59, 0x6C, 0xB0, 0x62, 0xCB, 0x15, 
   0xB7, 0x74, 0xB7, 0x88, 0x13, 0x6F, 0xBC, 0x61, 0xFC, 0x53, 0xAF, 0x7E, 0x28, 0x8D, 0xA5, 0x4B, 
   0x8E, 0x6B, 0x1E, 0xD4, 0x9F, 0x21, 0x73, 0x95, 0xB0, 0x12, 0x6D, 0xF3, 0xC0, 0x9C, 0x3C, 0x39, 
   0xB4, 0x21, 0x8F, 0x86, 0xD9, 0x43, 0x04, 0xB2, 0xEC, 0x4E, 0x16, 0xA3, 0x98, 0x17, 0x7E, 0x66, 
   0xDC, 0x5A, 0x70, 0x44, 0xC5, 0x38, 0x8A, 0xCC, 0x94, 0x6D, 0xE6, 0xD6, 0x38, 0xD0, 0xB9, 0x36, 
   0x7D, 0xD1, 0xB1, 0x45, 0x4D, 0x3F, 0x2D, 0xF5, 0xA0, 0x0D, 0x1F, 0x8D, 0x05, 0xCB, 0x26, 0xFB, 
   0xCD, 0x41, 0x69, 0x9B, 0xAD, 0x18, 0x0D, 0xF1, 0xFB, 0x8C, 0xDA, 0x81, 0xED, 0xB7, 0x48, 0xE1, 
   0x7B, 0xCA, 0xAF, 0xC1, 0xE1, 0x05, 0x7C, 0x39, 0xE1, 0xCC, 0x19, 0x45, 0x69, 0x91, 0x29, 0xD9, 
   0x3E, 0x22, 0x3F, 0x44, 0xE2, 0x66, 0xCC, 0xFB, 0xCF, 0xD0, 0xE6, 0x4D, 0x54, 0xDC, 0x11, 0x9C, 
   0x41, 0x1C, 0x6E, 0xB2, 0x5B, 0x60, 0x52, 0x8B, 0x16, 0x30, 0x4D, 0x54, 0x76, 0xBD, 0xBE, 0x06, 
   0xCD, 0x61, 0xDB, 0xB8, 0xA3, 0xB6, 0x88, 0x7E, 0x2E, 0x13, 0xA5, 0xB9, 0xC7, 0x5E, 0x4C, 0x00, 
   0x1E, 0x10, 0x9F, 0x51, 0xC4, 0x29, 0x02, 0x03, 0x01, 0x00, 0x01, 0xA3, 0x42, 0x30, 0x40, 0x30, 
   0x0E, 0x06, 0x03, 0x55, 0x1D, 0x0F, 0x01, 0x01, 0xFF, 0x04, 0x04, 0x03, 0x02, 0x01, 0x06, 0x30, 
   0x0F, 0x06, 0x03, 0x55, 0x1D, 0x13, 0x01, 0x01, 0xFF, 0x04, 0x05, 0x30, 0x03, 0x01, 0x01, 0xFF, 
   0x30, 0x1D, 0x06, 0x03, 0x55, 0x1D, 0x0E, 0x04, 0x16, 0x04, 0x14, 0x79, 0x58, 0x98, 0x83, 0xF7, 
   0x9A, 0xA2, 0x00, 0x88, 0xA3, 0x88, 0xDC, 0x3C, 0x6A, 0x66, 0x8D, 0xE4, 0x29, 0x02, 0x86, 0x30, 
   0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x0B, 0x05, 0x00, 0x03, 0x82, 
   0x01, 0x01, 0x00, 0x19, 0x64, 0xA2, 0x29, 0x25, 0x09, 0x39, 0x62, 0xD9, 0x40, 0x1C, 0xBE, 0xD3, 
   0x94, 0x99, 0x73, 0x39, 0x76, 0x97, 0x55, 0xC4, 0x9B, 0x1A, 0xAB, 0xB9, 0xAD, 0x7E, 0x8A, 0x23, 
   0xDE, 0x26, 0x81, 0x18, 0x59, 0xB3, 0xAC, 0x8B, 0x39, 0xE2, 0x88, 0x36, 0x18, 0x1F, 0x24, 0xCD, 
   0xC0, 0xBC, 0x96, 0xA7, 0x39, 0xCD, 0x49, 0x98, 0x9F, 0x97, 0x62, 0x18, 0x5B, 0x80, 0x9B, 0xDD, 
   0xD3, 0x10, 0x3A, 0x35, 0x15, 0x67, 0x87, 0x07, 0x4E, 0xBC, 0x45, 0xF4, 0xAC, 0x7A, 0x27, 0xE9, 
   0x78, 0x2B, 0xF0, 0x3E, 0x0F, 0xF7, 0xD6, 0x65, 0x08, 0x69, 0xCF, 0x6F, 0x96, 0x8C, 0x46, 0x3D, 
   0x87, 0x9E, 0x75, 0xA7, 0xFC, 0x4F, 0x59, 0x25, 0xD6, 0xAD, 0x77, 0x41, 0x80, 0x8E, 0x68, 0x6D, 
   0x14, 0x52, 0x5A, 0x09, 0x05, 0x8C, 0xB6, 0xDE, 0x9F, 0x0F, 0x20, 0x71, 0x20, 0x84, 0xD2, 0xB0, 
   0xEA, 0x08, 0xBF, 0x06, 0xEC, 0xEB, 0xF1, 0x76, 0x20, 0xC2, 0x48, 0x8A, 0xED, 0x57, 0xB7, 0xF3, 
   0xEE, 0xD6, 0x6F, 0x8E, 0x75, 0x11, 0x2F, 0x8F, 0x56, 0x56, 0x1B, 0x4D, 0xA5, 0xF2, 0x9C, 0x95, 
   0x6B, 0x36, 0x95, 0xED, 0xCC, 0xDC, 0x4F, 0x02, 0x05, 0x37, 0xDA, 0x36, 0x30, 0xED, 0xAF, 0x35, 
   0x59, 0x82, 0xF0, 0x75, 0xCB, 0x71, 0x03, 0xF0, 0x54, 0x19, 0xC6, 0xC1, 0xEC, 0x2F, 0xD7, 0xC1, 
   0xA1, 0x72, 0xF6, 0x8E, 0x56, 0x9A, 0x6F, 0x62, 0x5E, 0x76, 0xE4, 0x41, 0x32, 0x5A, 0x4C, 0xA5, 
   0x13, 0x04, 0x95, 0x7C, 0xF8, 0xDA, 0x7B, 0x57, 0x93, 0x0B, 0x76, 0xC5, 0xB8, 0xEA, 0xE8, 0x00, 
   0x0A, 0x14, 0x81, 0x9A, 0xA6, 0x1A, 0x05, 0xFE, 0x31, 0x62, 0x72, 0x93, 0xA1, 0x3A, 0x18, 0x38, 
   0xF4, 0x49, 0x8C, 0x04, 0x94, 0x98, 0xF4, 0xF1, 0xDE, 0xBD, 0x9C, 0x30, 0x19, 0x2C, 0xB8, 0xA1, 
   0x58, 0xBA, 0xFF, 0xFF, 0x00, 0x04, 0x01, 0x00, 0x00, 0x01, 0x00, 0x01, 0xAD, 0xDA, 0xA9, 0xB3, 
   0x9A, 0x4A, 0xD1, 0xEE, 0x80, 0x70, 0x0E, 0x79, 0x36, 0x75, 0x92, 0x16, 0x15, 0x5C, 0x13, 0x5D, 
   0x76, 0x9E, 0xB1, 0x21, 0x93, 0xC3, 0x3E, 0x1C, 0xEF, 0xB2, 0xA0, 0x59, 0xD8, 0xDF, 0xAB, 0x5E, 
   0xD3, 0x25, 0x8A, 0x94, 0xFE, 0x99, 0x0D, 0xC9, 0x0A, 0xD0, 0x8C, 0xBF, 0x5A, 0x1E, 0xBE, 0xD8, 
   0x95, 0xC9, 0xE3, 0x2B, 0x4B, 0x47, 0xC0, 0xBD, 0x02, 0xC6, 0xB2, 0xB0, 0x5F, 0xA4, 0x2C, 0x31, 
   0xBF, 0xE9, 0x71, 0xB8, 0xEF, 0xDD, 0x9F, 0xA0, 0xA4, 0x1A, 0xC8, 0xA1, 0x46, 0xDB, 0xED, 0x9A, 
   0x59, 0x6C, 0xB0, 0x62, 0xCB, 0x15, 0xB7, 0x74, 0xB7, 0x88, 0x13, 0x6F, 0xBC, 0x61, 0xFC, 0x53, 
   0xAF, 0x7E, 0x28, 0x8D, 0xA5, 0x4B, 0x8E, 0x6B, 0x1E, 0xD4, 0x9F, 0x21, 0x73, 0x95, 0xB0, 0x12, 
   0x6D, 0xF3, 0xC0, 0x9C, 0x3C, 0x39, 0xB4, 0x21, 0x8F, 0x86, 0xD9, 0x43, 0x04, 0xB2, 0xEC, 0x4E, 
   0x16, 0xA3, 0x98, 0x17, 0x7E, 0x66, 0xDC, 0x5A, 0x70, 0x44, 0xC5, 0x38, 0x8A, 0xCC, 0x94, 0x6D, 
   0xE6, 0xD6, 0x38, 0xD0, 0xB9, 0x36, 0x7D, 0xD1, 0xB1, 0x45, 0x4D, 0x3F, 0x2D, 0xF5, 0xA0, 0x0D, 
   0x1F, 0x8D, 0x05, 0xCB, 0x26, 0xFB, 0xCD, 0x41, 0x69, 0x9B, 0xAD, 0x18, 0x0D, 0xF1, 0xFB, 0x8C, 
   0xDA, 0x81, 0xED, 0xB7, 0x48, 0xE1, 0x7B, 0xCA, 0xAF, 0xC1, 0xE1, 0x05, 0x7C, 0x39, 0xE1, 0xCC, 
   0x19, 0x45, 0x69, 0x91, 0x29, 0xD9, 0x3E, 0x22, 0x3F, 0x44, 0xE2, 0x66, 0xCC, 0xFB, 0xCF, 0xD0, 
   0xE6, 0x4D, 0x54, 0xDC, 0x11, 0x9C, 0x41, 0x1C, 0x6E, 0xB2, 0x5B, 0x60, 0x52, 0x8B, 0x16, 0x30, 
   0x4D, 0x54, 0x76, 0xBD, 0xBE, 0x06, 0xCD, 0x61, 0xDB, 0xB8, 0xA3, 0xB6, 0x88, 0x7E, 0x2E, 0x13, 
   0xA5, 0xB9, 0xC7, 0x5E, 0x4C, 0x00, 0x1E, 0x10, 0x9F, 0x51, 0xC4, 0x29, 0xE3, 0x96, 0xD4, 0x31, 
   0x12, 0x5A, 0x9A, 0x4F, 0x18, 0x27, 0x1C, 0x9A, 0xA3, 0x9F, 0x8D, 0xA7, 0xF5, 0xD5, 0x4D, 0x3F, 
   0x4F, 0x19, 0xB0, 0xF8, 0x85, 0x01, 0x78, 0xB0, 0x99, 0x79, 0x12, 0x03, 0x5E, 0xC3, 0xE0, 0x9A, 
   0x3D, 0xF1, 0xB4, 0x9B, 0x22, 0xF6, 0x36, 0xC6, 0xD6, 0xA6, 0x78, 0xCA, 0x1C, 0x53, 0x17, 0x19, 
   0x03, 0xA1, 0x3A, 0xC3, 0xB4, 0x17, 0x72, 0x55, 0xEC, 0xAA, 0x41, 0x3B, 0xB0, 0xC5, 0x4B, 0x60, 
   0x1E, 0xDD, 0x4D, 0x9D, 0x82, 0xDE, 0x76, 0x7C, 0x29, 0x72, 0xBC, 0x70, 0x6E, 0x10, 0x16, 0x73, 
   0x8D, 0x27, 0x83, 0x36, 0xD4, 0x94, 0x04, 0x98, 0xBA, 0xC3, 0xA3, 0x5D, 0x3F, 0x82, 0x94, 0x0B, 
   0x7D, 0x4D, 0xD4, 0x02, 0x3B, 0xF7, 0x66, 0xAC, 0xFE, 0x63, 0x03, 0xD7, 0xCB, 0xAE, 0xCC, 0x6D, 
   0x55, 0x93, 0x62, 0xE0, 0x70, 0x2E, 0xC5, 0x1D, 0xE1, 0xBD, 0x2E, 0xE7, 0xC3, 0x8E, 0x99, 0x6F, 
   0xC9, 0x34, 0xB8, 0x13, 0xB3, 0x7E, 0x5D, 0xA7, 0xDD, 0x71, 0x43, 0xCE, 0x66, 0xC4, 0xDE, 0x45, 
   0xBB, 0x98, 0xF0, 0x8A, 0xD8, 0xA6, 0x06, 0xAB, 0xC7, 0xA1, 0x14, 0x03, 0x6F, 0x52, 0xAC, 0x8F, 
   0xFA, 0xA7, 0xB1, 0x81, 0x57, 0xC6, 0xD9, 0x07, 0x08, 0xDD, 0xFF, 0x81, 0x5E, 0x10, 0xA5, 0x73, 
   0xDE, 0x70, 0xBE, 0x1A, 0xD5, 0xB5, 0xDC, 0x0B, 0x16, 0x67, 0xFA, 0x65, 0x20, 0x5B, 0xF9, 0x5A, 
   0x5C, 0xF9, 0x54, 0x85, 0x8F, 0xFC, 0xEA, 0x43, 0xDA, 0x33, 0x5F, 0x5B, 0x66, 0x59, 0xAE, 0xB9, 
   0x3E, 0x8C, 0x91, 0xD9, 0xEA, 0x3D, 0x9F, 0xBE, 0x2A, 0xDE, 0x72, 0xF1, 0xF9, 0xF9, 0xF3, 0x4F, 
   0x8E, 0x1A, 0xD0, 0xE2, 0xBE, 0x89, 0xA3, 0x47, 0x99, 0x73, 0x31, 0x18, 0xB1, 0x9E, 0x8C, 0x49, 
   0x83, 0x21, 0x0C, 0xBD, 0x14, 0x1B, 0xB1, 0x69, 0x7E, 0x3A, 0x62, 0x6F, 0xCE, 0x1E, 0x19, 0xCA, 
   0xDF, 0x8E, 0x82, 0xD6, 0x43, 0x4F, 0x98, 0xCE, 0x4C, 0x86, 0x02, 0x2B, 0x2D, 0xAF, 0xA2, 0xA8, 
   0x45, 0xA1, 0x44, 0xEF, 0xAE, 0xB5, 0xE8, 0x72, 0x38, 0x6C, 0xB7, 0xED, 0xA9, 0x73, 0xC9, 0x04, 
   0xA8, 0x39, 0x31, 0x92, 0x97, 0x15, 0x5A, 0x02, 0xB7, 0x00, 0x49, 0xC0, 0xF1, 0xEA, 0x26, 0xAF, 
   0x16, 0xE4, 0x7C, 0x6E, 0x25, 0xBA, 0x5E, 0x68, 0x87, 0x50, 0xA2, 0x87, 0xC6, 0xCE, 0xC8, 0x37, 
   0x23, 0x7C, 0xD6, 0x00, 0x63, 0x37, 0xCB, 0x23, 0x23, 0xFE, 0xAF, 0xBF, 0x3B, 0x4F, 0x02, 0xA6, 
   0x60, 0x1E, 0x7A, 0xED, 0xBB, 0x94, 0xDA, 0x9C, 0xDF, 0xF8, 0xB3, 0x09, 0x8E, 0xAD, 0x5A, 0x1B, 
   0x15, 0xBE, 0xD8, 0xD5, 0xB5, 0x2D, 0x99, 0x25, 0xEF, 0xB6, 0x09, 0x12, 0xF5, 0x7B, 0x37, 0xD5, 
   0x85, 0x7D, 0x58, 0x3D, 0x60, 0x1C, 0x5B, 0x95, 0x76, 0x8E, 0x79, 0xDD, 0x8A, 0xF9, 0xD9, 0xA3, 
   0x6E, 0xFB, 0xAF, 0x62, 0x18, 0xEA, 0xD2, 0x46, 0x4D, 0x02, 0x84, 0xAC, 0xB7, 0xAE, 0x6B, 0x44, 
   0x65, 0x78, 0xE0, 0x61, 0xDC, 0x6B, 0xC9, 0x4B, 0xE5, 0x38, 0x5D, 0x4F, 0xBF, 0x9A, 0xA2, 0x96, 
   0x44, 0x0D, 0x4F, 0x01, 0xDB, 0xCE, 0xAE, 0x47, 0xE8, 0x8E, 0x54, 0x59, 0xAC, 0xEE, 0xE9, 0x96, 
   0x79, 0xDB, 0xE7, 0xCE, 0x8C, 0x58, 0x8D, 0x03, 0xB8, 0x2D, 0xB6, 0xEE, 0x8D, 0x5B, 0xAF, 0xCE, 
   0xFF, 0x4A, 0x16, 0x3E, 0x41, 0x40, 0xFD, 0x7F, 0xB1, 0x1F, 0x57, 0x42, 0x4E, 0x6F, 0xA7, 0xD3, 
   0x70, 0x57, 0x58, 0x03, 0xE5, 0x0B, 0x5C, 0x6E, 0x3A, 0x6B, 0x12, 0x87, 0x53, 0x1E, 0xC6, 0x42, 
   0xA0, 0x7C, 0x00, 0x3D, 0x54, 0x29, 0xDE, 0xC7, 0x30, 0x8F, 0x83, 0xB1, 0xC7, 0xF1, 0x24, 0x43, 
   0xCE, 0x13, 0xFB, 0xC8, 0x97, 0xF4, 0xC2, 0x55, 0x75, 0x66, 0xAA, 0xB3, 0x17, 0x9B, 0x59, 0x2F, 
   0xB2, 0xA0, 0xC9, 0x52, 0x33, 0x03, 0x6F, 0x67, 0x40, 0x50, 0x82, 0xC6, 0x25, 0x39, 0x8D, 0x49, 
   0x38, 0x00, 0x89, 0xE8, 0xBF, 0xBD, 0x5F, 0xA3, 0x39, 0x3B, 0x0E, 0x2E, 0x45, 0x56, 0xAD, 0xA8, 
   0xDE, 0x2B, 0x18, 0x36, 0x1C, 0x6D, 0x68, 0xD8, 0xC8, 0x6A, 0xC2, 0x68, 0x1B, 0xE6, 0x3C, 0xDC, 
   0x19, 0x91, 0x1A, 0xE1, 0x0D, 0xD4, 0xDE, 0x9F, 0x4C, 0x8C, 0x22, 0x3B, 0xA4, 0xC5, 0xE4, 0xB2, 
   0x08, 0xAF, 0xB5, 0x22, 0xE0, 0x37, 0x92, 0xFC, 0xB6, 0xF6, 0x08, 0x8C, 0x12, 0x0E, 0xC7, 0x73, 
   0x8F, 0xB9, 0xC5, 0x56, 0x97, 0x82, 0xE1, 0x88, 0xF3, 0xBA, 0xBF, 0x28, 0x2B, 0x79, 0x7F, 0x88, 
   0x3B, 0x8E, 0x20, 0xAF, 0x34, 0x44, 0x16, 0xD9, 0x67, 0xFD, 0x8A, 0x0A, 0xBF, 0x23, 0x39, 0x60, 
   0x8B, 0x21, 0xE9, 0x04, 0x2A, 0x81, 0x21, 0xF7, 0x13, 0x8F, 0xA0, 0x3B, 0xFF, 0xFF, 0xFF, 0xFF
};
#endif


#if SHARKSSL_USE_ECC
/* example CA certificate and its relevant EC private key 
 * obtained with SharkSSL\tools\SharkSslParseCert
 *                  SharkSSL\examples\certificates\CA_RTL_EC_256.pem
 *                  SharkSSL\examples\certificates\private\CA_RTL_EC_256.key
 */ 
const U8 sharkSslECCertCA_RTL[688] =
{
   0x30, 0x82, 0x02, 0x44, 0x30, 0x82, 0x01, 0xE9, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x01, 0x01, 
   0x30, 0x0A, 0x06, 0x08, 0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x04, 0x03, 0x02, 0x30, 0x81, 0x88, 0x31, 
   0x0B, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x1C, 0x30, 0x1A, 
   0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x13, 0x52, 0x65, 0x61, 0x6C, 0x20, 0x54, 0x69, 0x6D, 0x65, 
   0x20, 0x4C, 0x6F, 0x67, 0x69, 0x63, 0x20, 0x4C, 0x4C, 0x43, 0x31, 0x11, 0x30, 0x0F, 0x06, 0x03, 
   0x55, 0x04, 0x0B, 0x13, 0x08, 0x53, 0x68, 0x61, 0x72, 0x6B, 0x53, 0x53, 0x4C, 0x31, 0x20, 0x30, 
   0x1E, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x17, 0x52, 0x65, 0x61, 0x6C, 0x20, 0x54, 0x69, 0x6D, 
   0x65, 0x20, 0x4C, 0x6F, 0x67, 0x69, 0x63, 0x20, 0x52, 0x6F, 0x6F, 0x74, 0x20, 0x43, 0x41, 0x31, 
   0x26, 0x30, 0x24, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x09, 0x01, 0x16, 0x17, 
   0x67, 0x69, 0x6E, 0x66, 0x6F, 0x40, 0x72, 0x65, 0x61, 0x6C, 0x74, 0x69, 0x6D, 0x65, 0x6C, 0x6F, 
   0x67, 0x69, 0x63, 0x2E, 0x63, 0x6F, 0x6D, 0x30, 0x1E, 0x17, 0x0D, 0x31, 0x33, 0x31, 0x30, 0x30, 
   0x34, 0x30, 0x38, 0x35, 0x38, 0x35, 0x38, 0x5A, 0x17, 0x0D, 0x32, 0x33, 0x31, 0x30, 0x30, 0x32, 
   0x30, 0x38, 0x35, 0x38, 0x35, 0x38, 0x5A, 0x30, 0x81, 0x88, 0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 
   0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x1C, 0x30, 0x1A, 0x06, 0x03, 0x55, 0x04, 0x0A, 
   0x13, 0x13, 0x52, 0x65, 0x61, 0x6C, 0x20, 0x54, 0x69, 0x6D, 0x65, 0x20, 0x4C, 0x6F, 0x67, 0x69, 
   0x63, 0x20, 0x4C, 0x4C, 0x43, 0x31, 0x11, 0x30, 0x0F, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x08, 
   0x53, 0x68, 0x61, 0x72, 0x6B, 0x53, 0x53, 0x4C, 0x31, 0x20, 0x30, 0x1E, 0x06, 0x03, 0x55, 0x04, 
   0x03, 0x13, 0x17, 0x52, 0x65, 0x61, 0x6C, 0x20, 0x54, 0x69, 0x6D, 0x65, 0x20, 0x4C, 0x6F, 0x67, 
   0x69, 0x63, 0x20, 0x52, 0x6F, 0x6F, 0x74, 0x20, 0x43, 0x41, 0x31, 0x26, 0x30, 0x24, 0x06, 0x09, 
   0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x09, 0x01, 0x16, 0x17, 0x67, 0x69, 0x6E, 0x66, 0x6F, 
   0x40, 0x72, 0x65, 0x61, 0x6C, 0x74, 0x69, 0x6D, 0x65, 0x6C, 0x6F, 0x67, 0x69, 0x63, 0x2E, 0x63, 
   0x6F, 0x6D, 0x30, 0x59, 0x30, 0x13, 0x06, 0x07, 0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x02, 0x01, 0x06, 
   0x08, 0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x03, 0x01, 0x07, 0x03, 0x42, 0x00, 0x04, 0x47, 0x98, 0xE9, 
   0x49, 0x01, 0x08, 0x89, 0x4F, 0x5E, 0x73, 0x78, 0x90, 0x37, 0x79, 0x2E, 0x58, 0x19, 0xBB, 0xEB, 
   0x9C, 0xAA, 0x39, 0x89, 0x43, 0x9F, 0xE0, 0x95, 0x6F, 0x5E, 0xF6, 0x1D, 0x17, 0x1F, 0x70, 0x94, 
   0xC1, 0x7D, 0x42, 0xD8, 0x61, 0xFF, 0x5F, 0x9A, 0xF8, 0x46, 0x65, 0x95, 0x8B, 0x50, 0xF3, 0x4B, 
   0x2B, 0x61, 0x3E, 0xDC, 0x18, 0x49, 0xA5, 0x8C, 0x4E, 0x6E, 0x7D, 0x2A, 0x6A, 0xA3, 0x42, 0x30, 
   0x40, 0x30, 0x0E, 0x06, 0x03, 0x55, 0x1D, 0x0F, 0x01, 0x01, 0xFF, 0x04, 0x04, 0x03, 0x02, 0x01, 
   0x06, 0x30, 0x0F, 0x06, 0x03, 0x55, 0x1D, 0x13, 0x01, 0x01, 0xFF, 0x04, 0x05, 0x30, 0x03, 0x01, 
   0x01, 0xFF, 0x30, 0x1D, 0x06, 0x03, 0x55, 0x1D, 0x0E, 0x04, 0x16, 0x04, 0x14, 0x03, 0x58, 0xA1, 
   0xBE, 0x4F, 0xDC, 0x8F, 0xA1, 0x1F, 0xBB, 0xBC, 0xA1, 0xAA, 0xE6, 0x3E, 0xC0, 0xDB, 0x56, 0x1F, 
   0x18, 0x30, 0x0A, 0x06, 0x08, 0x2A, 0x86, 0x48, 0xCE, 0x3D, 0x04, 0x03, 0x02, 0x03, 0x49, 0x00, 
   0x30, 0x46, 0x02, 0x21, 0x00, 0xDC, 0x5C, 0xD7, 0x3D, 0x33, 0x0F, 0xC8, 0x8E, 0x2E, 0x2E, 0x56, 
   0xC7, 0xAB, 0x61, 0x36, 0x3F, 0xC1, 0x0E, 0x7A, 0xAC, 0xB3, 0xE5, 0x09, 0x40, 0xD4, 0xF7, 0xA1, 
   0x01, 0xC8, 0x82, 0x51, 0x1D, 0x02, 0x21, 0x00, 0xE8, 0x27, 0x6E, 0x5D, 0x41, 0x08, 0x94, 0x0D, 
   0x35, 0xA8, 0xD9, 0xFB, 0xE0, 0x8B, 0x61, 0x6F, 0xB1, 0xC6, 0xC7, 0x9C, 0x09, 0xA2, 0x44, 0xAD, 
   0xF1, 0xE6, 0x60, 0x45, 0xB0, 0xAC, 0x4A, 0x5A, 0x02, 0x20, 0x17, 0x20, 0x46, 0x9A, 0x28, 0x15, 
   0xAB, 0x51, 0xB3, 0x35, 0x63, 0xD3, 0x45, 0xDA, 0xFF, 0x65, 0xA0, 0x2F, 0x10, 0xA4, 0x99, 0x12, 
   0x02, 0x6B, 0x6B, 0x95, 0xA6, 0x07, 0x3E, 0xAC, 0x0B, 0x4D, 0x37, 0x64, 0x47, 0x98, 0xE9, 0x49, 
   0x01, 0x08, 0x89, 0x4F, 0x5E, 0x73, 0x78, 0x90, 0x37, 0x79, 0x2E, 0x58, 0x19, 0xBB, 0xEB, 0x9C, 
   0xAA, 0x39, 0x89, 0x43, 0x9F, 0xE0, 0x95, 0x6F, 0x5E, 0xF6, 0x1D, 0x17, 0x1F, 0x70, 0x94, 0xC1, 
   0x7D, 0x42, 0xD8, 0x61, 0xFF, 0x5F, 0x9A, 0xF8, 0x46, 0x65, 0x95, 0x8B, 0x50, 0xF3, 0x4B, 0x2B, 
   0x61, 0x3E, 0xDC, 0x18, 0x49, 0xA5, 0x8C, 0x4E, 0x6E, 0x7D, 0x2A, 0x6A, 0xFF, 0xFF, 0xFF, 0xFF
};
#endif
#endif  /* SHARKSSL_ENABLE_CSR_SIGNING */


/* Replace with a function that prints to a console or create a stub
 * that does nothing.
 */
void _xprintf(const char* fmt, ...)
{
   va_list varg;
   va_start(varg, fmt);
   vprintf(fmt, varg);
   va_end(varg);
} 


#if SHARKSSL_ENABLE_ASN1_KEY_CREATION
#if (SHARKSSL_USE_ECC && SHARKSSL_ENABLE_ECCKEY_CREATE)
void printOutECKey(U8 *ecKeyData, int ecKeyDataLen)
{
   static const char beginECKey[]={"-----BEGIN EC PRIVATE KEY-----\n"};
   static const char endECKey[]={"\n-----END EC PRIVATE KEY-----\n"};

   printOutBase64(ecKeyData, ecKeyDataLen, beginECKey, endECKey);
}
#endif


#if (SHARKSSL_ENABLE_RSA && SHARKSSL_ENABLE_RSAKEY_CREATE)
void printOutRSAKey(U8 *rsaKeyData, int rsaKeyDataLen)
{
   static const char beginRSAKey[]={"-----BEGIN RSA PRIVATE KEY-----\n"};
   static const char endRSAKey[]={"\n-----END RSA PRIVATE KEY-----\n"};

   printOutBase64(rsaKeyData, rsaKeyDataLen, beginRSAKey, endRSAKey);
}
#endif
#endif


int main()
{
   #if SHARKSSL_ENABLE_CSR_CREATION
   U8 buf[2048];
   SharkSslASN1Create asn;
   SharkSslCertDN subject;
   SharkSslBitExtReq keyUsage;
   SharkSslBitExtReq nsCertType;
   U8 *csrData = NULL;
   int csrDataLen;

   #if SHARKSSL_ENABLE_RSA
   SharkSslKey privKeyRSA;
   #if SHARKSSL_ENABLE_RSAKEY_CREATE
   int klen_RSA;
   #endif
   #endif

   #if SHARKSSL_USE_ECC
   SharkSslKey privKeyECC;
   #if SHARKSSL_ENABLE_ECCKEY_CREATE
   int klen_ECC; 
   #endif
   #endif

   /* double separators (;) are ignored, a final separator is optional */
   const static char *subjAltNames = "realtimelogic.com;sharkssl.com;embeddedwebserver.net;IP:127.0.0.1";

   sharkssl_entropy(0xDEADBEEF);  /* do not forget to initialize the RNG! */
   sharkssl_entropy(baGetUnixTime());   /* do not forget to seed the RNG! */

   SharkSslCertDN_constructor(&subject);
   SharkSslCertDN_setCommonName(&subject,"www.realtimelogic.com");
   SharkSslCertDN_setCountryName(&subject,"US");
   SharkSslCertDN_setUnit(&subject,"SharkSSL development");
   SharkSslCertDN_setProvince(&subject,"California");
   SharkSslCertDN_setLocality(&subject,"Laguna Niguel");
   SharkSslCertDN_setOrganization(&subject,"Real Time Logic");
   SharkSslCertDN_setEmailAddress(&subject,"info@realtimelogic.com");

   keyUsage.bits =
      SHARKSSL_X509_KU_DIGITAL_SIGNATURE |
      SHARKSSL_X509_KU_NON_REPUDIATION |
      SHARKSSL_X509_KU_KEY_ENCIPHERMENT |
      SHARKSSL_X509_KU_DATA_ENCIPHERMENT |
      SHARKSSL_X509_KU_KEY_AGREEMENT |
      SHARKSSL_X509_KU_KEY_CERT_SIGN |
      SHARKSSL_X509_KU_CRL_SIGN;
   
   nsCertType.bits =
      SHARKSSL_X509_NS_CERT_TYPE_SSL_CLIENT |
      SHARKSSL_X509_NS_CERT_TYPE_SSL_SERVER |
      SHARKSSL_X509_NS_CERT_TYPE_OBJECT_SIGNING |
      SHARKSSL_X509_NS_CERT_TYPE_SSL_CA |
      SHARKSSL_X509_NS_CERT_TYPE_OBJECT_SIGNING_CA;

   #if SHARKSSL_USE_ECC
   /* create a CSR using a static FIPS EC key */

   /* convert the static EC key from PEM format to internal format */
   privKeyECC = (SharkSslECCKey)sharkssl_PEM_to_ECCKey(privECKeyPEM256, NULL);

   SharkSslASN1Create_constructor(&asn, buf, sizeof(buf));

   /* in the following function
    * SHARKSSL_HASHID_SHA256 can be replaced with:
    * SHARKSSL_HASHID_SHA384 
    * SHARKSSL_HASHID_SHA512
    */
   if (!SharkSslASN1Create_CSR(&asn,
                              privKeyECC,
                              SHARKSSL_HASHID_SHA256,
                              &subject,
                              (char*)subjAltNames,
                              &keyUsage,
                              &nsCertType))
   {
      printf("CSR with static ECC key succesfully created:\n\n");
      csrDataLen = SharkSslASN1Create_getDataLen(&asn, &csrData);
      printOutCSR(csrData, csrDataLen);

      #if SHARKSSL_ENABLE_CSR_SIGNING
      /* in the following function
       * SHARKSSL_HASHID_SHA256 can be replaced with:
       * SHARKSSL_HASHID_SHA384 
       * SHARKSSL_HASHID_SHA512
       */
      signCSR("ECS-EC", csrData, csrDataLen, sharkSslECCertCA_RTL, privKeyECC, SHARKSSL_HASHID_SHA256); 
      signCSR("SELFS-EC", csrData, csrDataLen, NULL, privKeyECC, SHARKSSL_HASHID_SHA256); 
      #endif
   }
   else
   {
      printf("error in creating the CSR with static ECC key\n");
   }
   /* release the memory occupied by the EC private key */
   SharkSslECCKey_free(privKeyECC);

   #if (SHARKSSL_ECC_USE_BRAINPOOLP256R1)
   /* create a CSR using a static Brainpool EC key */

   /* convert the static EC key from PEM format to internal format */
   privKeyECC = (SharkSslECCKey)sharkssl_PEM_to_ECCKey(privECBKeyPEM256, NULL);

   SharkSslASN1Create_constructor(&asn, buf, sizeof(buf));

   /* in the following function
    * SHARKSSL_HASHID_SHA256 can be replaced with:
    * SHARKSSL_HASHID_SHA384 
    * SHARKSSL_HASHID_SHA512
    */
   if (!SharkSslASN1Create_CSR(&asn,
                              privKeyECC,
                              SHARKSSL_HASHID_SHA256,
                              &subject,
                              (char*)subjAltNames,
                              &keyUsage,
                              &nsCertType))
   {
      printf("CSR with static ECC key succesfully created:\n\n");
      csrDataLen = SharkSslASN1Create_getDataLen(&asn, &csrData);
      printOutCSR(csrData, csrDataLen);

      #if SHARKSSL_ENABLE_CSR_SIGNING
      /* in the following function
       * SHARKSSL_HASHID_SHA256 can be replaced with:
       * SHARKSSL_HASHID_SHA384 
       * SHARKSSL_HASHID_SHA512
       */
      signCSR("ECS-ECB", csrData, csrDataLen, sharkSslECCertCA_RTL, privKeyECC, SHARKSSL_HASHID_SHA256); 
      signCSR("SELFS-ECB", csrData, csrDataLen, NULL, privKeyECC, SHARKSSL_HASHID_SHA256); 
      #endif
   }
   else
   {
      printf("error in creating the CSR with static ECC key\n");
   }
   /* release the memory occupied by the EC private key */
   SharkSslECCKey_free(privKeyECC);
   #endif


   #if SHARKSSL_ENABLE_ECCKEY_CREATE
   /* dynamically create an EC private key 
    * binary format: "klen_ECC" bytes from "privKeyECC"
    * ----------------------------------------------------
    * in the following function
    * SHARKSSL_EC_CURVE_ID_SECP256R1 can be replaced with:
    * SHARKSSL_EC_CURVE_ID_SECP384R1
    * SHARKSSL_EC_CURVE_ID_SECP521R1
    */       
   klen_ECC = SharkSslECCKey_create(&privKeyECC, SHARKSSL_EC_CURVE_ID_SECP256R1);

   #if SHARKSSL_ENABLE_ASN1_KEY_CREATION
   SharkSslASN1Create_constructor(&asn, buf, sizeof(buf));
   if (!SharkSslASN1Create_key(&asn, privKeyECC))
   {
      printOutECKey(SharkSslASN1Create_getData(&asn), SharkSslASN1Create_getLen(&asn));   
   }
   #endif

   SharkSslASN1Create_constructor(&asn, buf, sizeof(buf));
   if (!SharkSslASN1Create_CSR(&asn,
                              privKeyECC,
                              SHARKSSL_HASHID_SHA256,
                              &subject,
                              (char*)subjAltNames,
                              &keyUsage,
                              &nsCertType))
   {
      printf("CSR with dynamic ECC key succesfully created:\n\n");
      csrDataLen = SharkSslASN1Create_getDataLen(&asn, &csrData);
      printOutCSR(csrData, csrDataLen);

      #if SHARKSSL_ENABLE_CSR_SIGNING
      signCSR("ECD-EC", csrData, csrDataLen, sharkSslECCertCA_RTL, privKeyECC, SHARKSSL_HASHID_SHA256); 
      signCSR("SELFD-EC", csrData, csrDataLen, NULL, privKeyECC, SHARKSSL_HASHID_SHA256); 
      #endif
   }
   else
   {
      printf("error in creating the CSR with dynamic ECC key\n");
   }

   /* release the memory occupied by the EC private key */
   SharkSslECCKey_free(privKeyECC);
   #endif
   #endif

   #if SHARKSSL_ENABLE_RSA
   /* create a CSR using a static RSA key */
   
   /* convert the static RSA key from PEM format to internal format */
   privKeyRSA = sharkssl_PEM_to_RSAKey(privRSAKeyPEM2048, NULL);

   SharkSslASN1Create_constructor(&asn, buf, sizeof(buf));

   /* in the following function
    * SHARKSSL_HASHID_SHA256 can be replaced with:
    * SHARKSSL_HASHID_SHA384 
    * SHARKSSL_HASHID_SHA512
    */
   if (!SharkSslASN1Create_CSR(&asn,
                              privKeyRSA,
                              SHARKSSL_HASHID_SHA256,
                              &subject,
                              (char*)subjAltNames,
                              &keyUsage,
                              &nsCertType))
   {
      printf("CSR with static RSA key succesfully created:\n\n");
      csrDataLen = SharkSslASN1Create_getDataLen(&asn, &csrData);
      printOutCSR(csrData, csrDataLen);

      #if SHARKSSL_ENABLE_CSR_SIGNING
      /* in the following function
       * SHARKSSL_HASHID_SHA256 can be replaced with:
       * SHARKSSL_HASHID_SHA384 
       * SHARKSSL_HASHID_SHA512
       */
      signCSR("RSAS-RSA", csrData, csrDataLen, sharkSslRSACertCA_RTL, privKeyRSA, SHARKSSL_HASHID_SHA256); 
      signCSR("SELFS-RSA", csrData, csrDataLen, NULL, privKeyRSA, SHARKSSL_HASHID_SHA256); 
      #endif
   }
   else
   {
      printf("error in creating the CSR with static RSA key\n");
   }
   /* release the memory occupied by the RSA private key */
   SharkSslRSAKey_free(privKeyRSA);


   #if SHARKSSL_ENABLE_RSAKEY_CREATE
   /* dynamically create an RSA private key 
    * binary format: "klen_RSA" bytes from "privKeyRSA"
    * ----------------------------------------------------
    * in the following function
    * 2048 can be replaced with:
    * 1024 (weaker key, faster generation)
    * 4096 (stronger key, slower generation)
    */       
   klen_RSA = SharkSslRSAKey_create(&privKeyRSA, 2048);

   #if SHARKSSL_ENABLE_ASN1_KEY_CREATION
   SharkSslASN1Create_constructor(&asn, buf, sizeof(buf));
   if (!SharkSslASN1Create_key(&asn, privKeyRSA))
   {
      printOutRSAKey(SharkSslASN1Create_getData(&asn), SharkSslASN1Create_getLen(&asn));   
   }
   #endif

   SharkSslASN1Create_constructor(&asn, buf, sizeof(buf));
   if (!SharkSslASN1Create_CSR(&asn,
                              privKeyRSA,
                              SHARKSSL_HASHID_SHA256,
                              &subject,
                              (char*)subjAltNames,
                              &keyUsage,
                              &nsCertType))
   {
      printf("CSR with dynamic RSA key succesfully created:\n\n");
      csrDataLen = SharkSslASN1Create_getDataLen(&asn, &csrData);
      printOutCSR(csrData, csrDataLen);

      #if SHARKSSL_ENABLE_CSR_SIGNING
      signCSR("RSAD-RSA", csrData, csrDataLen, sharkSslRSACertCA_RTL, privKeyRSA, SHARKSSL_HASHID_SHA256); 
      signCSR("SELFD-RSA", csrData, csrDataLen, NULL, privKeyRSA, SHARKSSL_HASHID_SHA256); 
      #endif
   }
   else
   {
      printf("error in creating the CSR with dynamic RSA key\n");
   }

   /* release the memory occupied by the RSA private key */
   SharkSslRSAKey_free(privKeyRSA);
   #endif
   #endif
   #endif  /* SHARKSSL_ENABLE_CSR_CREATION */

   #if SHARKSSL_ENABLE_CSR_SIGNING
   #if SHARKSSL_ENABLE_RSA
   signCSR("TESTRSA-RSA", (U8*)csrTest, sizeof(csrTest)/sizeof(csrTest[0]), sharkSslRSACertCA_RTL, (U8*)csrTestKey, SHARKSSL_HASHID_SHA256); 
   #endif
   #endif

   return 0;
}
